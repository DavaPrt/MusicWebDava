<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dava Music - Spotify-like Playlists</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --primary: #2f9e44;
      --secondary: #69db7c;
      --light: #d3f9d8;
      --dark: #1a7c2c;
      --text: #fff;
      --bg: linear-gradient(135deg, #111, #222);
      --card: rgba(0, 0, 0, 0.4);
      --shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
      --hover-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      --search-bg: rgba(255, 255, 255, 0.1);
      --playlist-bg: rgba(30, 30, 40, 0.7);
      --modal-bg: rgba(25, 25, 35, 0.95);
      --google: #4285F4;
      --facebook: #4267B2;
      --delete-red: #e74c3c;
      --info-blue: #3498db;
      --stats-purple: #9b59b6;
      --share-green: #2ecc71;
    }
    
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow-x: hidden;
      padding-top: 80px;
      padding-bottom: 100px;
      min-height: 100vh;
      position: relative;
      transition: background 0.5s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    /* Container utama untuk konten tengah */
    .main-container {
      max-width: 1400px;
      width: 100%;
      padding: 0 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    /* Background overlay */
    .background-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      z-index: -2;
      opacity: 0.5;
      transition: all 0.8s ease;
      filter: saturate(1.2) brightness(0.9);
      background-attachment: fixed;
    }
    
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.4));
      z-index: -1;
      transition: all 0.5s ease;
    }
    
    /* Header - Fixed di atas */
    header {
      position: fixed; 
      top: 0;
      left: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(12px);
      padding: 15px 20px;
      font-size: 1.5rem;
      font-weight: 600;
      color: #fff;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .header-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .logo {
      height: 36px;
      width: 36px;
      object-fit: contain;
      filter: drop-shadow(0 2px 3px rgba(0,0,0,0.1));
    }
    
    .login-section {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .login-toggle {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 20px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      box-shadow: 0 3px 8px rgba(47, 158, 68, 0.3);
    }
    
    .login-toggle:hover {
      background: var(--dark);
      transform: translateY(-2px);
      box-shadow: 0 5px 12px rgba(47, 158, 68, 0.4);
    }
    
    .bg-toggle {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 15px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }
    
    .bg-toggle:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }
    
    /* Perbaikan tombol logout */
    .logout-button {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      font-size: 0.9rem;
      display: none;
      cursor: pointer;
    }
    
    .logout-button:hover {
      background: rgba(255, 0, 0, 0.2);
      transform: scale(1.1);
    }
    
    .logout-button span {
      display: none;
    }
    
    /* Search Bar */
    .search-container {
      max-width: 600px;
      width: 100%;
      margin: 0 auto 25px;
      padding: 0 20px;
      position: relative;
      display: flex;
      justify-content: center;
    }
    
    .search-box {
      display: flex;
      align-items: center;
      background: var(--search-bg);
      border-radius: 50px;
      padding: 10px 20px;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      width: 100%;
      max-width: 600px;
    }
    
    .search-box:focus-within {
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(255, 255, 255, 0.2);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
    }
    
    .search-box i {
      color: #bbb;
      font-size: 1.2rem;
      margin-right: 12px;
    }
    
    .search-input {
      flex: 1;
      background: transparent;
      border: none;
      color: white;
      font-size: 1rem;
      font-family: 'Poppins', sans-serif;
      outline: none;
      padding: 8px 0;
      width: 100%;
    }
    
    .search-input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }
    
    .search-results-count {
      position: absolute;
      right: 35px;
      top: 50%;
      transform: translateY(-50%);
      background: var(--primary);
      color: white;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 2px 10px;
      border-radius: 12px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .search-box:focus-within .search-results-count {
      opacity: 1;
    }
    
    /* Login Popup */
    .login-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(0);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      transform: scale(0.95);
    }
    
    .login-container.show {
      opacity: 1;
      pointer-events: all;
      backdrop-filter: blur(8px);
      transform: scale(1);
    }
    
    .login-box {
      background: rgba(30, 30, 30, 0.95);
      padding: 40px;
      border-radius: 24px;
      width: 90%;
      max-width: 420px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.5);
      transform: scale(0.85);
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .login-container.show .login-box {
      transform: scale(1);
    }
    
    .login-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
    }
    
    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: #ccc;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 10;
    }
    
    .close-btn:hover {
      background: var(--primary);
      color: white;
      border-color: var(--primary);
      transform: rotate(90deg);
    }
    
    .login-box h2 {
      color: var(--secondary);
      margin-bottom: 30px;
      text-align: center;
      font-weight: 700;
      font-size: 1.8rem;
    }
    
    .input-group {
      margin-bottom: 20px;
      position: relative;
    }
    
    .input-group i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #999;
    }
    
    .login-box input {
      width: 100%;
      padding: 14px 45px 14px 45px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.3s;
      background: rgba(0, 0, 0, 0.3);
      color: white;
    }
    
    .login-box input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(47, 158, 68, 0.2);
      background: rgba(0, 0, 0, 0.5);
    }
    
    .password-container {
      position: relative;
      display: flex;
      align-items: center;
    }
    
    .toggle-password {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #bbb;
      font-size: 1.1rem;
      background: rgba(0, 0, 0, 0.3);
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.3s;
    }
    
    .toggle-password:hover {
      background: rgba(0, 0, 0, 0.5);
      color: var(--secondary);
    }
    
    .login-btn {
      width: 100%;
      padding: 14px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 10px;
      box-shadow: 0 4px 10px rgba(47, 158, 68, 0.3);
    }
    
    .login-btn:hover {
      background: var(--dark);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(47, 158, 68, 0.4);
    }
    
    .social-login {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 25px;
    }
    
    .social-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 12px;
      border-radius: 12px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
      color: white;
    }
    
    .social-btn.google {
      background: var(--google);
    }
    
    .social-btn.facebook {
      background: var(--facebook);
    }
    
    .social-btn.guest {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .social-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    
    /* Intro text */
    .intro-text {
      font-size: 1.3rem;
      color: var(--secondary);
      margin: 30px 0 5px;
      text-align: center;
      font-weight: 500;
      padding: 0 20px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      width: 100%;
      max-width: 800px;
    }
    
    /* Sambutan pengguna yang lebih elegan */
    .welcome-user {
      font-family: 'Playfair Display', serif;
      font-size: 1rem;
      color: var(--light);
      margin: 0 0 20px;
      text-align: center;
      font-weight: 400;
      padding: 0 20px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      width: 100%;
      max-width: 800px;
      display: none;
      letter-spacing: 0.5px;
      font-style: italic;
    }
    
    /* Music List */
    .music-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 20px;
      padding: 20px;
      width: 100%;
      justify-items: center;
    }
    
    /* Playlist Grid */
    .playlist-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 25px;
      padding: 20px;
      width: 100%;
      justify-items: center;
    }
    
    .music-player {
      background: var(--card);
      padding: 15px;
      border-radius: 16px;
      box-shadow: var(--shadow);
      text-align: center;
      opacity: 0;
      transform: translateY(30px) scale(0.9);
      transition: all 0.6s ease;
      position: relative;
      transition: transform 0.3s, box-shadow 0.3s;
      height: 380px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      width: 100%;
      max-width: 240px;
    }
    
    .playlist-card {
      background: var(--playlist-bg);
      padding: 20px;
      border-radius: 18px;
      box-shadow: var(--shadow);
      text-align: center;
      position: relative;
      height: 260px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      width: 100%;
      max-width: 220px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      overflow: hidden;
    }
    
    .playlist-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.7));
      z-index: 1;
      opacity: 0.7;
      transition: opacity 0.4s;
    }
    
    .playlist-card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: var(--hover-shadow);
      background: rgba(40, 40, 50, 0.7);
    }
    
    .playlist-card:hover::before {
      opacity: 0.5;
    }
    
    .playlist-card .cover-container {
      position: relative;
      height: 140px;
      width: 140px;
      margin: 0 auto 15px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
      z-index: 2;
    }
    
    .playlist-card .cover {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s;
    }
    
    .playlist-card:hover .cover {
      transform: scale(1.05);
    }
    
    .playlist-card .playlist-name {
      font-weight: 700;
      font-size: 1.1rem;
      margin-bottom: 5px;
      color: #fff;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      z-index: 2;
      text-shadow: 0 1px 3px rgba(0,0,0,0.6);
    }
    
    .playlist-card .song-count {
      font-size: 0.9rem;
      color: var(--secondary);
      z-index: 2;
      font-weight: 500;
    }
    
    .playlist-card .play-button {
      position: absolute;
      bottom: 15px;
      right: 15px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50%;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: all 0.3s;
      z-index: 3;
      transform: translateY(10px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .playlist-card:hover .play-button {
      opacity: 1;
      transform: translateY(0);
    }
    
    .playlist-card .play-button i {
      font-size: 1.1rem;
    }
    
    .music-player.animate-in {
      opacity: 1;
      transform: translateY(0) scale(1);
      animation: popUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    @keyframes popUp {
      0% { transform: translateY(30px) scale(0.9); opacity: 0; }
      70% { transform: translateY(-10px) scale(1.05); opacity: 1; }
      100% { transform: translateY(0) scale(1); opacity: 1; }
    }
    
    .music-player:hover {
      transform: translateY(-5px);
      box-shadow: var(--hover-shadow);
      background: rgba(0, 0, 0, 0.5);
    }
    
    .player-top {
      position: relative;
      flex: 1;
      display: flex;
      flex-direction: column;
      margin-bottom: 10px;
    }
    
    .player-bottom {
      margin-top: auto;
    }
    
    .cover-container {
      position: relative;
      display: inline-block;
      margin-bottom: 10px;
    }
    
    /* Tombol di cover container */
    .cover-btn {
      position: absolute;
      background: rgba(0, 0, 0, 0.4);
      border: none;
      font-size: 1.1rem;
      color: #ddd;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 10;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      backdrop-filter: blur(2px);
      right: 8px; /* Semua tombol di sisi kanan */
    }
    
    .cover-btn:hover {
      transform: scale(1.15);
    }
    
    .like-btn {
      top: 8px;
    }
    
    .like-btn:hover {
      background: rgba(255, 77, 109, 0.2);
    }
    
    .like-btn.liked {
      color: #ff4d6d;
      animation: pulse 0.5s;
    }
    
    /* Tombol kredit baru */
    .credit-btn {
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.4);
      color: #ddd;
    }
    
    .credit-btn:hover {
      background: rgba(52, 152, 219, 0.3);
      color: var(--info-blue);
    }
    
    /* Tombol tambah ke playlist */
    .add-to-playlist-btn {
      bottom: 8px;
      background: rgba(0, 0, 0, 0.4);
      color: #ddd;
    }
    
    .add-to-playlist-btn:hover {
      background: rgba(47, 158, 68, 0.3);
      color: var(--secondary);
    }
    
    .add-to-playlist-btn.added {
      color: var(--secondary);
      background: rgba(47, 158, 68, 0.4);
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    
    .cover {
      width: 140px;
      height: 140px;
      border-radius: 10px;
      object-fit: cover;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
      transition: transform 0.3s ease;
    }
    
    .cover.playing {
      animation: subtlePulse 2s infinite ease-in-out;
      box-shadow: 0 10px 25px rgba(47, 158, 68, 0.5);
    }
    
    @keyframes subtlePulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.03); }
      100% { transform: scale(1); }
    }
    
    .song-title {
      font-weight: 700;
      font-size: 1.1rem;
      margin-bottom: 3px;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      line-height: 1.3;
      max-height: 3.2rem;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      min-height: 3.2rem;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }
    
    .artist {
      font-size: 0.85rem;
      color: #bbb;
      margin-bottom: 12px;
      font-weight: 400;
      max-height: 1.3rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      min-height: 1.3rem;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }
    
    .controls {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin: 10px 0 15px;
    }
    
    .controls button {
      background-color: var(--primary);
      border: none;
      color: white;
      padding: 10px;
      border-radius: 50%;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      width: 38px;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }
    
    .controls button:hover {
      background-color: var(--dark);
      transform: scale(1.1);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
    }
    
    .progress-container {
      position: relative;
      margin-bottom: 8px;
    }
    
    .progress-bar {
      width: 100%;
      height: 5px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 5px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
    }
    
    .progress {
      height: 100%;
      width: 0%;
      background: var(--secondary);
      transition: width 0.1s linear;
      border-radius: 5px;
    }
    
    .progress-bar:hover .progress {
      background: var(--primary);
    }
    
    .progress-handle {
      position: absolute;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: white;
      border: 2px solid var(--primary);
      opacity: 0;
      transition: opacity 0.2s;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      pointer-events: none;
    }
    
    .progress-bar:hover .progress-handle {
      opacity: 1;
    }
    
    .time-display {
      font-size: 0.8rem;
      color: #bbb;
      display: flex;
      justify-content: space-between;
      margin-top: 4px;
      font-weight: 500;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }
    
    /* Bottom Navigation - Fixed di bawah */
    .bottom-nav {
      position: fixed; 
      bottom: 0;
      left: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(5px);
    }
    
    .nav-item {
      flex: 1;
      text-align: center;
      padding: 14px 0;
      font-size: 0.85rem;
      color: #aaa;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }
    
    .nav-item i {
      font-size: 1.3rem;
      transition: transform 0.3s;
      color: #ccc;
    }
    
    .nav-item.active {
      color: var(--secondary);
      background: rgba(47, 158, 68, 0.15);
    }
    
    .nav-item.active i {
      transform: translateY(-3px);
      color: var(--secondary);
    }
    
    .nav-item:hover {
      background: rgba(47, 158, 68, 0.1);
    }
    
    /* Footer */
    footer {
      text-align: center;
      padding: 25px 20px 80px;
      font-size: 0.85rem;
      color: #777;
      max-width: 600px;
      margin: 0 auto;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }
    
    /* Background selector */
    .bg-selector {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: rgba(30, 30, 30, 0.95);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
      z-index: 3000;
      width: 90%;
      max-width: 500px;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .bg-selector.show {
      opacity: 1;
      pointer-events: all;
      transform: translate(-50%, -50%) scale(1);
    }
    
    .bg-options {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin: 20px 0;
    }
    
    .bg-option {
      height: 80px;
      border-radius: 8px;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      transition: all 0.3s;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
      transform: scale(0.95);
      opacity: 0.8;
    }
    
    .bg-option:hover {
      transform: scale(1);
      opacity: 1;
      box-shadow: 0 5px 15px rgba(0,0,0,0.4);
    }
    
    .bg-option::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      transition: all 0.3s;
    }
    
    .bg-option:hover::before {
      background: rgba(0, 0, 0, 0.1);
    }
    
    .bg-option.active {
      border: 3px solid var(--primary);
      box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.5);
      transform: scale(1);
      opacity: 1;
    }
    
    .bg-title {
      text-align: center;
      margin-bottom: 20px;
      color: var(--secondary);
      font-size: 1.5rem;
      font-weight: 600;
    }
    
    /* Now playing indicator */
    .now-playing {
      position: absolute;
      top: 8px;
      left: 8px;
      background: var(--primary);
      color: white;
      font-size: 0.65rem;
      padding: 2px 6px;
      border-radius: 8px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 4px;
      z-index: 10;
    }
    
    /* Tampilan playlist kosong */
    .empty-playlist {
      text-align: center;
      padding: 40px;
      color: #aaa;
      font-style: italic;
      grid-column: 1 / -1;
      width: 100%;
    }
    
    /* Playlist Modal */
    .playlist-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: var(--modal-bg);
      padding: 30px;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
      z-index: 3000;
      width: 90%;
      max-width: 500px;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    .playlist-modal.show {
      opacity: 1;
      pointer-events: all;
      transform: translate(-50%, -50%) scale(1);
    }
    
    .playlist-modal h3 {
      text-align: center;
      margin-bottom: 25px;
      color: var(--secondary);
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    .playlist-list {
      max-height: 300px;
      overflow-y: auto;
      margin-bottom: 20px;
      padding-right: 10px;
    }
    
    .playlist-list::-webkit-scrollbar {
      width: 8px;
    }
    
    .playlist-list::-webkit-scrollbar-thumb {
      background-color: var(--primary);
      border-radius: 4px;
    }
    
    .playlist-item {
      display: flex;
      align-items: center;
      padding: 15px;
      border-radius: 14px;
      margin-bottom: 12px;
      background: rgba(255, 255, 255, 0.05);
      cursor: pointer;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .playlist-item:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(5px);
      border-color: rgba(255, 255, 255, 0.15);
    }
    
    .playlist-item img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      object-fit: cover;
      margin-right: 15px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    
    .playlist-item .playlist-info {
      flex: 1;
      text-align: left;
    }
    
    .playlist-item .playlist-name {
      font-weight: 600;
      font-size: 1.05rem;
      color: #fff;
      margin-bottom: 3px;
    }
    
    .playlist-item .song-count {
      font-size: 0.85rem;
      color: var(--secondary);
      font-weight: 500;
    }
    
    .playlist-item .add-icon {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--secondary);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .playlist-item:hover .add-icon {
      opacity: 1;
    }
    
    .new-playlist-btn {
      width: 100%;
      padding: 15px;
      background: transparent;
      color: var(--secondary);
      border: 2px dashed var(--secondary);
      border-radius: 14px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 10px;
    }
    
    .new-playlist-btn:hover {
      background: rgba(105, 219, 124, 0.1);
      transform: translateY(-2px);
    }
    
    .new-playlist-btn i {
      font-size: 1.2rem;
    }
    
    /* Create Playlist Modal */
    .create-playlist-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: var(--modal-bg);
      padding: 35px;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
      z-index: 3000;
      width: 90%;
      max-width: 500px;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    .create-playlist-modal.show {
      opacity: 1;
      pointer-events: all;
      transform: translate(-50%, -50%) scale(1);
    }
    
    .create-playlist-modal h3 {
      text-align: center;
      margin-bottom: 30px;
      color: var(--secondary);
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    .playlist-input-container {
      margin-bottom: 25px;
      position: relative;
    }
    
    .playlist-input-container i {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--secondary);
      font-size: 1.2rem;
    }
    
    .playlist-input {
      width: 100%;
      padding: 16px 16px 16px 55px;
      border: 2px solid rgba(255, 255, 255, 0.15);
      border-radius: 16px;
      font-size: 1.1rem;
      transition: all 0.3s;
      background: rgba(0, 0, 0, 0.4);
      color: white;
      font-family: 'Poppins', sans-serif;
      letter-spacing: 0.5px;
      font-weight: 500;
    }
    
    .playlist-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(47, 158, 68, 0.2);
      background: rgba(0, 0, 0, 0.6);
    }
    
    .playlist-input::placeholder {
      color: rgba(255, 255, 255, 0.5);
      font-weight: 400;
    }
    
    .create-playlist-btn {
      width: 100%;
      padding: 16px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 16px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(47, 158, 68, 0.3);
      letter-spacing: 0.5px;
    }
    
    .create-playlist-btn:hover {
      background: var(--dark);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(47, 158, 68, 0.4);
    }
    
    /* Tombol kembali */
    .back-button {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: none;
      border-radius: 20px;
      padding: 8px 20px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      margin-bottom: 20px;
    }
    
    .back-button:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }
    
    /* Confirmation Modal */
    .confirmation-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 4000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    
    .confirmation-modal.show {
      opacity: 1;
      pointer-events: all;
    }
    
    .confirmation-box {
      background: var(--modal-bg);
      padding: 30px;
      border-radius: 20px;
      text-align: center;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    .confirmation-box h3 {
      color: var(--secondary);
      margin-bottom: 20px;
      font-size: 1.5rem;
    }
    
    .confirmation-box p {
      margin-bottom: 25px;
      font-size: 1.1rem;
      color: #ddd;
    }
    
    .confirmation-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    
    .confirmation-cancel, .confirmation-delete {
      padding: 12px 30px;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
    }
    
    .confirmation-cancel {
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }
    
    .confirmation-cancel:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .confirmation-delete {
      background: var(--delete-red);
      color: white;
    }
    
    .confirmation-delete:hover {
      background: #c0392b;
    }
    
    /* Global Audio Player */
    .global-audio-container {
      position: fixed;
      bottom: 60px;
      left: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.85);
      padding: 12px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      z-index: 999;
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.3);
      transform: translateY(100px);
      transition: transform 0.3s ease;
    }
    
    .global-audio-container.show {
      transform: translateY(0);
    }
    
    .global-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      object-fit: cover;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    
    .global-cover.playing {
      animation: subtlePulse 2s infinite ease-in-out;
    }
    
    .global-track-info {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    
    .global-song-title {
      font-weight: 600;
      font-size: 1rem;
      color: white;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .global-artist {
      font-size: 0.85rem;
      color: var(--secondary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .global-progress-container {
      width: 100%;
      margin-top: 5px;
    }
    
    .global-progress-bar {
      width: 100%;
      height: 4px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 5px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
    }
    
    .global-progress {
      height: 100%;
      width: 0%;
      background: var(--secondary);
      transition: width 0.1s linear;
      border-radius: 5px;
    }
    
    .global-time-display {
      display: flex;
      justify-content: space-between;
      font-size: 0.75rem;
      color: #bbb;
      margin-top: 4px;
    }
    
    .global-controls {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .global-play-btn {
      background: var(--primary);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .global-play-btn:hover {
      transform: scale(1.1);
      background: var(--dark);
    }
    
    /* Modal Kredit Lagu Baru */
    .credits-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 4000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    
    .credits-modal.show {
      opacity: 1;
      pointer-events: all;
    }
    
    .credits-box {
      background: var(--modal-bg);
      padding: 30px;
      border-radius: 20px;
      text-align: center;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
      border: 1px solid rgba(255, 255, 255, 0.15);
      position: relative;
    }
    
    .credits-box h3 {
      color: var(--info-blue);
      margin-bottom: 20px;
      font-size: 1.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    
    .credits-content {
      text-align: left;
      margin-bottom: 25px;
      font-size: 1.1rem;
      color: #ddd;
      line-height: 1.6;
    }
    
    .credits-item {
      display: flex;
      margin-bottom: 12px;
      padding-bottom: 12px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .credits-label {
      font-weight: 600;
      width: 120px;
      color: var(--secondary);
    }
    
    .credits-value {
      flex: 1;
    }
    
    .close-credits {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: #ccc;
      cursor: pointer;
      transition: all 0.3s;
      z-index: 10;
    }
    
    .close-credits:hover {
      background: var(--info-blue);
      color: white;
      border-color: var(--info-blue);
      transform: rotate(90deg);
    }
    
    /* Edit Playlist Modal */
    .edit-playlist-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: var(--modal-bg);
      padding: 35px;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
      z-index: 3000;
      width: 90%;
      max-width: 500px;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    .edit-playlist-modal.show {
      opacity: 1;
      pointer-events: all;
      transform: translate(-50%, -50%) scale(1);
    }
    
    .edit-playlist-modal h3 {
      text-align: center;
      margin-bottom: 30px;
      color: var(--info-blue);
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    /* Share Modal */
    .share-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: var(--modal-bg);
      padding: 30px;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
      z-index: 3000;
      width: 90%;
      max-width: 500px;
      opacity: 0;
      pointer-events: none;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    .share-modal.show {
      opacity: 1;
      pointer-events: all;
      transform: translate(-50%, -50%) scale(1);
    }
    
    .share-modal h3 {
      text-align: center;
      margin-bottom: 25px;
      color: var(--share-green);
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    .share-link-container {
      display: flex;
      margin-bottom: 25px;
    }
    
    .share-link {
      flex: 1;
      padding: 12px 15px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px 0 0 10px;
      color: #ddd;
      font-size: 0.9rem;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .copy-btn {
      padding: 12px 20px;
      background: var(--share-green);
      color: white;
      border: none;
      border-radius: 0 10px 10px 0;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .copy-btn:hover {
      background: #27ae60;
    }
    
    .share-options {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }
    
    .share-option {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .share-option.facebook {
      background: var(--facebook);
    }
    
    .share-option.twitter {
      background: #1DA1F2;
    }
    
    .share-option.whatsapp {
      background: #25D366;
    }
    
    .share-option:hover {
      transform: translateY(-5px);
    }
    
    /* Stats Page */
    .stats-container {
      padding: 20px;
      width: 100%;
      max-width: 800px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .stat-card {
      background: var(--card);
      border-radius: 16px;
      padding: 20px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .stat-card h3 {
      color: var(--secondary);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .stat-card h3 i {
      font-size: 1.2rem;
    }
    
    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: white;
      text-align: center;
      margin: 15px 0;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .stat-label {
      text-align: center;
      color: #bbb;
      font-size: 0.9rem;
    }
    
    .top-songs {
      list-style: none;
      margin-top: 15px;
    }
    
    .top-song-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-radius: 10px;
      margin-bottom: 8px;
      background: rgba(255, 255, 255, 0.05);
    }
    
    .top-song-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .song-rank {
      width: 25px;
      height: 25px;
      background: var(--stats-purple);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      font-weight: 700;
      margin-right: 12px;
    }
    
    .song-info {
      flex: 1;
    }
    
    .song-title {
      font-size: 0.95rem;
      font-weight: 500;
    }
    
    .song-artist {
      font-size: 0.8rem;
      color: #bbb;
    }
    
    .song-plays {
      font-size: 0.9rem;
      color: var(--secondary);
      font-weight: 600;
    }
    
    /* Drag and Drop */
    .playlist-grid.dragging {
      cursor: grabbing;
    }
    
    .playlist-card.dragging {
      opacity: 0.5;
      transform: scale(0.95);
    }
    
    .playlist-card.drag-over {
      border: 2px dashed var(--secondary);
    }

    /* Tombol Action Bar untuk Playlist */
    .playlist-actions {
      position: absolute;
      bottom: 10px;
      left: 0;
      right: 0;
      display: flex;
      justify-content: center;
      gap: 12px;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s ease;
      z-index: 3;
    }
    
    .playlist-card:hover .playlist-actions {
      opacity: 1;
      transform: translateY(0);
    }
    
    .action-btn {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      cursor: pointer;
      transition: all 0.3s;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-size: 0.9rem;
    }
    
    .action-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    
    .edit-btn {
      background: rgba(52, 152, 219, 0.3);
    }
    
    .edit-btn:hover {
      background: rgba(52, 152, 219, 0.5);
    }
    
    .share-btn {
      background: rgba(46, 204, 113, 0.3);
    }
    
    .share-btn:hover {
      background: rgba(46, 204, 113, 0.5);
    }
    
    .delete-btn {
      background: rgba(231, 76, 60, 0.3);
    }
    
    .delete-btn:hover {
      background: rgba(231, 76, 60, 0.5);
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      body {
        padding-top: 70px;
      }
      
      .music-list {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
      }
      
      .playlist-grid {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      }
      
      .playlist-card {
        max-width: 160px;
        height: 240px;
        padding: 15px;
      }
      
      .playlist-card .cover-container {
        width: 120px;
        height: 120px;
      }
      
      .header-left span {
        font-size: 1.3rem;
      }
      
      .login-toggle span {
        display: none;
      }
      
      .login-toggle i {
        font-size: 1.2rem;
        margin-right: 5px;
      }
      
      .bg-toggle span {
        display: none;
      }
      
      .login-box {
        padding: 30px 25px;
      }
      
      .music-player {
        height: 360px;
      }
      
      .cover {
        width: 120px;
        height: 120px;
      }
      
      .bg-options {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .search-results-count {
        display: none;
      }
      
      .nav-item span {
        font-size: 0.75rem;
      }
      
      .global-audio-container {
        padding: 10px 15px;
        gap: 10px;
      }
      
      .global-cover {
        width: 40px;
        height: 40px;
      }
      
      .global-track-info {
        min-width: 100px;
      }
      
      .global-song-title {
        font-size: 0.9rem;
      }
      
      .global-artist {
        font-size: 0.75rem;
      }
      
      .global-progress-container {
        display: block;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .nav-item span {
        display: none;
      }
      
      .nav-item i {
        font-size: 1.4rem;
      }
      
      .intro-text {
        font-size: 1.1rem;
      }
      
      .playlist-card {
        max-width: 140px;
        height: 220px;
      }
      
      .playlist-card .cover-container {
        width: 100px;
        height: 100px;
      }
      
      .global-track-info {
        flex: 2;
      }
      
      .global-progress-container {
        display: none;
      }
      
      .credits-box {
        padding: 25px 20px;
      }
      
      .credits-item {
        flex-direction: column;
      }
      
      .credits-label {
        width: 100%;
        margin-bottom: 5px;
      }
      
      .share-options {
        gap: 10px;
      }
      
      .share-option {
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
      }

      .action-btn {
        width: 28px;
        height: 28px;
        font-size: 0.8rem;
      }
    }
  </style>
</head>
<body>
  <!-- Background overlay -->
  <div class="background-overlay" id="backgroundOverlay" style="background-image: url('https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&auto=format&fit=crop&w=1500&q=80')"></div>
  <div class="overlay"></div>
  
  <!-- Header with Login - Fixed di atas -->
  <header>
    <div class="header-left">
      <img src="Dapalog.jpg" alt="Logo" class="logo">
      <span>Dava Music ðŸŽ§</span>
    </div>
    
    <div class="login-section">
      <button class="bg-toggle" onclick="toggleBgSelector()">
        <i class="fas fa-image"></i> <span>Background</span>
      </button>
      <button class="login-toggle" id="loginButton" onclick="toggleLogin()">
        <i class="fas fa-user"></i> <span id="loginText">Login</span>
      </button>
      <button class="logout-button" id="logoutButton" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i> <span>Logout</span>
      </button>
    </div>
  </header>
  
  <!-- Background Selector -->
  <div class="bg-selector" id="bgSelector">
    <div class="bg-title">Pilih Background</div>
    <div class="bg-options">
      <div class="bg-option" style="background-image: url('https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80')" data-bg="https://images.unsplash.com/photo-1511379938547-c1f69419868d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1500&q=80"></div>
      <div class="bg-option" style="background-image: url('https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80')" data-bg="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?ixlib=rb-4.0.3&auto=format&fit=crop&w=1500&q=80"></div>
      <div class="bg-option" style="background-image: url('https://images.unsplash.com/photo-1507838153414-b4b713384a76?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80')" data-bg="https://images.unsplash.com/photo-1507838153414-b4b713384a76?ixlib=rb-4.0.3&auto=format&fit=crop&w=1500&q=80"></div>
      <div class="bg-option" style="background-image: url('https://images.unsplash.com/photo-1514525253161-7a46d19cd819?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80')" data-bg="https://images.unsplash.com/photo-1514525253161-7a46d19cd819?ixlib=rb-4.0.3&auto=format&fit=crop&w=1500&q=80"></div>
      <div class="bg-option" style="background-image: url('https://images.unsplash.com/photo-1487180144351-b8472da7d491?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80')" data-bg="https://images.unsplash.com/photo-1487180144351-b8472da7d491?ixlib=rb-4.0.3&auto=format&fit=crop&w=1500&q=80"></div>
      <div class="bg-option" style="background-image: url('https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80')" data-bg="https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?ixlib=rb-4.0.3&auto=format&fit=crop&w=1500&q=80"></div>
    </div>
    <button class="login-btn" onclick="toggleBgSelector()">Tutup</button>
  </div>
  
  <!-- Login Popup -->
  <div class="login-container" id="loginContainer">
    <div class="login-box">
      <button class="close-btn" onclick="toggleLogin()">
        <i class="fas fa-times"></i>
      </button>
      <h2>Login Dava Music</h2>
      
      <div class="input-group">
        <i class="fas fa-user"></i>
        <input type="text" placeholder="Username" id="username">
      </div>
      
      <div class="input-group password-container">
        <i class="fas fa-lock"></i>
        <input type="password" placeholder="Password" id="password">
        <span class="toggle-password" id="togglePassword">
          <i class="fas fa-eye-slash"></i>
        </span>
      </div>
      
      <button class="login-btn" onclick="login()">Masuk</button>
      
      <div class="social-login">
        <button class="social-btn google" onclick="loginWithGoogle()">
          <i class="fab fa-google"></i> Masuk dengan Google
        </button>
        <button class="social-btn facebook" onclick="loginWithFacebook()">
          <i class="fab fa-facebook-f"></i> Masuk dengan Facebook
        </button>
        <button class="social-btn guest" onclick="loginAsGuest()">
          <i class="fas fa-user-circle"></i> Masuk sebagai Tamu
        </button>
      </div>
    </div>
  </div>
  
  <!-- Playlist Modal -->
  <div class="playlist-modal" id="playlistModal">
    <button class="close-btn" onclick="togglePlaylistModal()">
      <i class="fas fa-times"></i>
    </button>
    <h3>Tambahkan ke Playlist</h3>
    
    <div class="playlist-list" id="playlistList">
      <!-- Daftar playlist akan diisi oleh JavaScript -->
    </div>
    
    <button class="new-playlist-btn" onclick="showCreatePlaylistModal()">
      <i class="fas fa-plus"></i> Buat Playlist Baru
    </button>
  </div>
  
  <!-- Create Playlist Modal -->
  <div class="create-playlist-modal" id="createPlaylistModal">
    <button class="close-btn" onclick="toggleCreatePlaylistModal()">
      <i class="fas fa-times"></i>
    </button>
    <h3>Buat Playlist Baru</h3>
    
    <div class="playlist-input-container">
      <i class="fas fa-heading"></i>
      <input type="text" class="playlist-input" id="playlistName" placeholder="Nama playlist kreatif Anda...">
    </div>
    
    <button class="create-playlist-btn" onclick="createNewPlaylist()">Buat Playlist</button>
  </div>
  
  <!-- Edit Playlist Modal -->
  <div class="edit-playlist-modal" id="editPlaylistModal">
    <button class="close-btn" onclick="toggleEditPlaylistModal()">
      <i class="fas fa-times"></i>
    </button>
    <h3>Edit Playlist</h3>
    
    <div class="playlist-input-container">
      <i class="fas fa-heading"></i>
      <input type="text" class="playlist-input" id="editPlaylistName" placeholder="Nama playlist baru...">
    </div>
    
    <button class="create-playlist-btn" onclick="updatePlaylistName()">Simpan Perubahan</button>
  </div>
  
  <!-- Share Modal -->
  <div class="share-modal" id="shareModal">
    <button class="close-btn" onclick="toggleShareModal()">
      <i class="fas fa-times"></i>
    </button>
    <h3>Bagikan Playlist</h3>
    
    <div class="share-link-container">
      <div class="share-link" id="shareLink">https://dava-music.app/playlist/<span id="playlistIdSpan"></span></div>
      <button class="copy-btn" onclick="copyShareLink()">Salin</button>
    </div>
    
    <p style="text-align: center; margin-bottom: 20px; color: #bbb;">Bagikan playlist Anda ke platform lain:</p>
    
    <div class="share-options">
      <div class="share-option facebook" onclick="shareToFacebook()">
        <i class="fab fa-facebook-f"></i>
      </div>
      <div class="share-option twitter" onclick="shareToTwitter()">
        <i class="fab fa-twitter"></i>
      </div>
      <div class="share-option whatsapp" onclick="shareToWhatsApp()">
        <i class="fab fa-whatsapp"></i>
      </div>
    </div>
  </div>
  
  <!-- Confirmation Modal -->
  <div class="confirmation-modal" id="confirmationModal">
    <div class="confirmation-box">
      <h3>Hapus Playlist</h3>
      <p>Apakah Anda yakin ingin menghapus playlist ini?</p>
      <div class="confirmation-buttons">
        <button class="confirmation-cancel" onclick="cancelDelete()">Batal</button>
        <button class="confirmation-delete" onclick="confirmDelete()">Hapus</button>
      </div>
    </div>
  </div>
  
  <!-- Credits Modal Baru -->
  <div class="credits-modal" id="creditsModal">
    <div class="credits-box">
      <button class="close-credits" onclick="toggleCreditsModal()">
        <i class="fas fa-times"></i>
      </button>
      <h3><i class="fas fa-info-circle"></i> Kredit Lagu</h3>
      
      <div class="credits-content" id="creditsContent">
        <!-- Konten kredit akan diisi oleh JavaScript -->
      </div>
    </div>
  </div>
  
  <!-- Global Audio Player -->
  <div class="global-audio-container" id="globalAudioContainer">
    <img id="globalCover" src="" alt="Cover" class="global-cover">
    <div class="global-track-info">
      <div class="global-song-title" id="globalSongTitle"></div>
      <div class="global-artist" id="globalArtist"></div>
      <div class="global-progress-container">
        <div class="global-progress-bar" id="globalProgressBar">
          <div id="globalProgress" class="global-progress"></div>
        </div>
        <div class="global-time-display">
          <span id="globalCurrentTime">0:00</span>
          <span id="globalDuration">0:00</span>
        </div>
      </div>
    </div>
    <div class="global-controls">
      <button class="global-play-btn" id="globalPlayBtn">
        <i class="fas fa-pause"></i>
      </button>
    </div>
  </div>
  
  <!-- Konten Utama -->
  <div class="main-container">
    <!-- Intro Text -->
    <div class="intro-text" id="viewTitle">
      Temukan irama terbaik untuk harimu ðŸŽ¶
    </div>
    
    <!-- Sambutan pengguna yang lebih elegan -->
    <div class="welcome-user" id="welcomeUser">
      Selamat datang kembali, <span id="userName">Pengguna</span>! Nikmati pengalaman musik terbaikmu.
    </div>
    
    <!-- Tombol Kembali (akan ditampilkan di view playlist dan liked) -->
    <button class="back-button" id="backButton" onclick="goToHome()" style="display: none;">
      <i class="fas fa-arrow-left"></i> Kembali ke Beranda
    </button>
    
    <!-- Search Bar -->
    <div class="search-container" id="searchContainer">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" class="search-input" id="searchInput" placeholder="Cari lagu atau artis...">
        <div class="search-results-count" id="resultsCount">0 hasil</div>
      </div>
    </div>
    
    <!-- Music List -->
    <div class="music-list" id="musicList">
      <!-- Songs will be populated by JavaScript -->
    </div>
    
    <!-- Playlist Grid -->
    <div class="playlist-grid" id="playlistGrid">
      <!-- Playlist cards will be populated by JavaScript -->
    </div>
    
    <!-- Stats Page -->
    <div class="stats-container" id="statsContainer" style="display: none;">
      <div class="intro-text">Statistik Musik Anda</div>
      
      <div class="stats-grid">
        <div class="stat-card">
          <h3><i class="fas fa-clock"></i> Waktu Mendengarkan</h3>
          <div class="stat-value" id="totalListeningTime">0 jam</div>
          <div class="stat-label">Total waktu yang Anda habiskan untuk mendengarkan musik</div>
        </div>
        
        <div class="stat-card">
          <h3><i class="fas fa-heart"></i> Lagu Favorit</h3>
          <div class="stat-value" id="totalLikedSongs">0 lagu</div>
          <div class="stat-label">Total lagu yang Anda sukai</div>
        </div>
        
        <div class="stat-card">
          <h3><i class="fas fa-play-circle"></i> Lagu Teratas</h3>
          <ul class="top-songs" id="topSongsList">
            <!-- Top songs will be populated by JavaScript -->
          </ul>
        </div>
        
        <div class="stat-card">
          <h3><i class="fas fa-list"></i> Playlist Terbanyak</h3>
          <div class="stat-value" id="topPlaylistName">-</div>
          <div class="stat-label">dengan <span id="topPlaylistCount">0</span> lagu</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer -->
  <footer>Â© 2025 Dava Music â€¢ Nikmati perjalanan musikmu dengan kebahagiaan ðŸŽ¶</footer>
  
  <!-- Bottom Navigation - Fixed di bawah -->
  <div class="bottom-nav">
    <div class="nav-item active" data-view="home">
      <i class="fas fa-home"></i>
      <span>Beranda</span>
    </div>
    <div class="nav-item" data-view="playlist">
      <i class="fas fa-list"></i>
      <span>Playlist</span>
    </div>
    <div class="nav-item" data-view="liked">
      <i class="fas fa-heart"></i>
      <span>Lagu Disukai</span>
    </div>
    <div class="nav-item" data-view="stats">
      <i class="fas fa-chart-line"></i>
      <span>Statistik</span>
    </div>
  </div>
  
  <!-- Audio Element -->
  <audio id="globalAudio"></audio>
  
  <script>
    // Music data dengan kredit
    const songs = [
      { 
        title: "A Line Without a Hook", 
        artist: "Ricky Montgomery", 
        cover: "ALW.jpg", 
        src: "A line without hook.mp3",
        credits: {
          penulis: "Ricky Montgomery & Jonathan Heisserer",
          produser: "Ricky Montgomery & Jonathan Heisserer",
          label: "Warner Records",
          tahun: "2020",
          durasi: "4:06"
        }
      },
      { 
        title: "Somebody Pleasure (Extended Version)", 
        artist: "Aziz Hendra", 
        cover: "Aziz.jpeg", 
        src: "somebodyPS.mp3",
        credits: {
          penulis: "Aziz Hendra , Eza Riyan Pratamma",
          produser: "Dimas Mufli Utomo",
          label: "Sony Music Entertainment",
          tahun: "2023",
          durasi: "4:41"
        }
      },
      { 
        title: "Tek it", 
        artist: "CafunÃ©", 
        cover: "Tek it.jpg", 
        src: "Tek it.mp3",
        credits: {
          penulis: "Noah Yoo , Sedona Schat",
          produser: "Noah Yoo",
          label: "Elektra [NEK]",
          tahun: "2022",
          durasi: "3:13"
        }
      },
      { 
        title: "End of Beginning", 
        artist: "Joe Keery", 
        cover: "DJO.jpg", 
        src: "the end.mp3",
        credits: {
          penulis: "The Weeknd",
          produser: " Joe Keery , Adam Thein",
          label: "Djo",
          tahun: "2022",
          durasi: "2:39"
        }
      },
      { 
        title: "As it was", 
        artist: "Harry Styles", 
        cover: "atis.jpg", 
        src: "atis.mp3",
        credits: {
          penulis: "Harry Styles, Kid Harpoon, and Tyler Johnson.",
          produser: " Tyler Johnson dan Jeff Bhasker",
          label: "Columbia Record",
          tahun: "2022",
          durasi: "2:43"
        }
      },
      { 
        title: "Desember", 
        artist: "Neck Deep", 
        cover: "desember.jpg", 
        src: "desember.mp3",
        credits: {
          penulis: "Neck Deep (terutama Ben Jackson)",
          produser: "Neck Deep",
          label: "Hopeless Records",
          tahun: "2015",
          durasi: "2:58"
        }
      },
      { 
        title: "Mr.Loverman", 
        artist: "Ricky Montgomery", 
        cover: "ALW.jpg", 
        src: "mrlover.mp3",
        credits: {
          penulis: " Ricky Montgomery",
          produser: "Ricky Montgomery, Baraka May",
          label: "Warner Records ",
          tahun: "2020",
          durasi: "3:18"
        }
      },
      { 
        title: "7 Years", 
        artist: "Lukas Graham", 
        cover: "7years.jpg", 
        src: "7years.mp3",
        credits: {
          penulis: " Lukas Forchhammer, Morten Ristorp, Stefan Forrest, Morten Pilegaard",
          produser: "Future Animals, Pilo",
          label: "Copenhagen Records, Warner Records",
          tahun: "2015",
          durasi: "3:36"
        }
      },
      { 
        title: "Disenchanted", 
        artist: "My Chemical Romance", 
        cover: "MC.jpg", 
        src: "MC.mp3",
        credits: {
          penulis: "Gerard Way, Mikey Way, Ray Toro, Frank Iero",
          produser: "Rob Cavallo, My Chemical Romance",
          label: "Reprise Records",
          tahun: "2006",
          durasi: "3:28"
        }
      },
      { 
        title: "Reckless", 
        artist: " Madison Beer", 
        cover: "reckless.jpg", 
        src: "reckless.mp3",
        credits: {
          penulis: "Madison Beer, Leroy Clampitt, Tim Sommers, Jeremy Dussolliet",
          produser: "Big Taste (Leroy Clampitt)",
          label: "Epic Records",
          tahun: "2021",
          durasi: "3:44"
        }
      },
      { 
        title: "Wish You Were Here", 
        artist: "Pink Floyd", 
        cover: "wishyou.jpg", 
        src: "wishyou.mp3",
        credits: {
          penulis: "Roger Waters, David Gilmour",
          label: " Pink Floyd",
          tahun: "1975",
          durasi: "3:44"
        }
      },
       { 
        title: "Bad Habit", 
        artist: "Steve Lacy", 
        cover: "badhabit.jpg", 
        src: "badhabit.mp3",
        credits: {
          penulis: "Steve Lacy, Diana Gordon, John Carroll Kirby, Matthew Castellanos",
          produser: "Steve Lacy",
          label: "RCA Records",
          tahun: "2022",
          durasi: "3:44"
        }
      },
       { 
        title: " Night Changes", 
        artist: "One Direction", 
        cover: "NG.jpg", 
        src: "NG.mp3",
        credits: {
          penulis: "Niall Horan, Liam Payne, Harry Styles, Zayn Malik, Louis Tomlinson, Jamie Scott, John Ryan, Julian Bunetta",
          produser: "Julian Bunetta",
          label: "Syco Music, Columbia Records",
          tahun: "2014",
          durasi: "3:44"
        }
      },
       { 
        title: " Until I Found You", 
        artist: "Stephen Sanchez", 
        cover: "UIFY.jpg", 
        src: "UIFY.mp3",
        credits: {
          penulis: "Ian Fitchuk",
          produser: "Big Taste (Leroy Clampitt)",
          label: "Republic Records",
          tahun: "2021",
          durasi: "3:44"
        }
      },
       { 
        title: " Dear God", 
        artist: " Dax", 
        cover: "DG.jpg", 
        src: "DG.mp3",
        credits: {
          penulis: "Daniel Nwosu Jr. (Dax)",
          produser: " Lex Nour Beats",
          label: " Independent (melalui Dax Music)",
          tahun: "2007",
          durasi: "3:44"
        }
      },

       { 
        title: "You're Gonna Live Forever in Me", 
        artist: "John Mayer", 
        cover: "bigbang.jpg", 
        src: "bigbang.mp3",
        credits: {
          penulis: "John Mayer",
          produser: "Steve Jordan",
          label: " The Search for Everything",
          tahun: "2017",
          durasi: "3:44"
        }
      },
       { 
        title: "Somewhere Only We Know", 
        artist: "Keane", 
        cover: "somewhere.jpg", 
        src: "somewhere.mp3",
        credits: {
          penulis: "Tim Rice-Oxley, Tom Chaplin, Richard Hughes",
          produser: " Andy Green, Keane",
          label: " Island Records",
          tahun: "2004",
          durasi: "3:44"
        }
      },
       { 
        title: "Rewrite the Stars", 
        artist: "Zac Efron & Zendaya", 
        cover: "rewrite.jpg", 
        src: "rewrite.mp3",
        credits: {
          penulis: "Benj Pasek, Justin Paul",
          produser: "Greg Wells",
          label: "Atlantic Records",
          tahun: "2017",
          durasi: "3:44"
        }
      },
       { 
        title: "Dandelions", 
        artist: "Ruth B.", 
        cover: "DD.jpg", 
        src: "DD.mp3",
        credits: {
          penulis: "Ruth Berhe",
          produser: "Patrick Wimberly",
          label: "Columbia Records",
          tahun: "2017",
          durasi: "3:44"
        }
      },
       { 
        title: " A Thousand Years", 
        artist: "Christina Perri", 
        cover: "ATY.jpg", 
        src: "ATY.mp3",
        credits: {
          penulis: "Christina Perri, David Hodges",
          produser: " David Hodges",
          label: " Atlantic Records",
          tahun: "2011",
          durasi: "3:44"
        }
      },
    ];
    
    // State management
    let likedSongs = [];
    let playlists = [];
    let currentPlaylistId = null;
    let currentIndex = -1;
    let isDragging = false;
    let draggingProgressId = null;
    let searchTerm = '';
    let selectedSongForPlaylist = -1;
    let currentUser = null;
    let playlistToDelete = null;
    let isPlaying = false;
    let currentView = 'home';
    let currentSongForCredits = -1;
    let playlistToEdit = null;
    let playlistToShare = null;
    let songPlays = {};
    let totalListeningTime = 0;
    let playlistOrder = [];
    
    // DOM elements
    const loginContainer = document.getElementById('loginContainer');
    const bgSelector = document.getElementById('bgSelector');
    const playlistModal = document.getElementById('playlistModal');
    const createPlaylistModal = document.getElementById('createPlaylistModal');
    const editPlaylistModal = document.getElementById('editPlaylistModal');
    const shareModal = document.getElementById('shareModal');
    const playlistList = document.getElementById('playlistList');
    const backgroundOverlay = document.getElementById('backgroundOverlay');
    const searchInput = document.getElementById('searchInput');
    const resultsCount = document.getElementById('resultsCount');
    const musicList = document.getElementById('musicList');
    const playlistGrid = document.getElementById('playlistGrid');
    const viewTitle = document.getElementById('viewTitle');
    const loginText = document.getElementById('loginText');
    const welcomeUser = document.getElementById('welcomeUser');
    const userNameSpan = document.getElementById('userName');
    const backButton = document.getElementById('backButton');
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('password');
    const confirmationModal = document.getElementById('confirmationModal');
    const creditsModal = document.getElementById('creditsModal');
    const creditsContent = document.getElementById('creditsContent');
    const globalAudio = document.getElementById('globalAudio');
    const globalAudioContainer = document.getElementById('globalAudioContainer');
    const globalCover = document.getElementById('globalCover');
    const globalSongTitle = document.getElementById('globalSongTitle');
    const globalArtist = document.getElementById('globalArtist');
    const globalPlayBtn = document.getElementById('globalPlayBtn');
    const globalProgressBar = document.getElementById('globalProgressBar');
    const globalProgress = document.getElementById('globalProgress');
    const globalCurrentTime = document.getElementById('globalCurrentTime');
    const globalDuration = document.getElementById('globalDuration');
    const loginButton = document.getElementById('loginButton');
    const logoutButton = document.getElementById('logoutButton');
    const statsContainer = document.getElementById('statsContainer');
    const totalListeningTimeEl = document.getElementById('totalListeningTime');
    const totalLikedSongsEl = document.getElementById('totalLikedSongs');
    const topSongsList = document.getElementById('topSongsList');
    const topPlaylistName = document.getElementById('topPlaylistName');
    const topPlaylistCount = document.getElementById('topPlaylistCount');
    const shareLink = document.getElementById('shareLink');
    const playlistIdSpan = document.getElementById('playlistIdSpan');
    const editPlaylistName = document.getElementById('editPlaylistName');
    
    // Timer for long press
    let pressTimer;
    
    // Toggle password visibility
    togglePassword.addEventListener('click', function() {
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      
      // Update icon based on visibility
      if (type === 'password') {
        this.innerHTML = '<i class="fas fa-eye-slash"></i>';
      } else {
        this.innerHTML = '<i class="fas fa-eye"></i>';
      }
    });
    
    function toggleLogin() {
      loginContainer.classList.toggle('show');
      document.body.style.overflow = loginContainer.classList.contains('show') ? 'hidden' : 'auto';
    }
    
    function toggleBgSelector() {
      bgSelector.classList.toggle('show');
      document.body.style.overflow = bgSelector.classList.contains('show') ? 'hidden' : 'auto';
    }
    
    function togglePlaylistModal() {
      playlistModal.classList.toggle('show');
      document.body.style.overflow = playlistModal.classList.contains('show') ? 'hidden' : 'auto';
    }
    
    function toggleCreatePlaylistModal() {
      createPlaylistModal.classList.toggle('show');
      document.body.style.overflow = createPlaylistModal.classList.contains('show') ? 'hidden' : 'auto';
    }
    
    function toggleEditPlaylistModal() {
      editPlaylistModal.classList.toggle('show');
      document.body.style.overflow = editPlaylistModal.classList.contains('show') ? 'hidden' : 'auto';
    }
    
    function toggleShareModal() {
      shareModal.classList.toggle('show');
      document.body.style.overflow = shareModal.classList.contains('show') ? 'hidden' : 'auto';
    }
    
    function toggleConfirmationModal() {
      confirmationModal.classList.toggle('show');
    }
    
    function toggleCreditsModal() {
      creditsModal.classList.toggle('show');
      document.body.style.overflow = creditsModal.classList.contains('show') ? 'hidden' : 'auto';
    }
    
    function setBackground(bgUrl) {
      backgroundOverlay.style.opacity = '0';
      setTimeout(() => {
        backgroundOverlay.style.backgroundImage = `url('${bgUrl}')`;
        backgroundOverlay.style.opacity = '0.5';
      }, 300);
      
      localStorage.setItem('davaMusicBg', bgUrl);
    }
    
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      
      if (username && password) {
        currentUser = {
          name: username,
          type: 'dava'
        };
        loginText.textContent = username;
        userNameSpan.textContent = username;
        welcomeUser.style.display = 'block';
        loginContainer.classList.remove('show');
        document.body.style.overflow = 'auto';
        showNotification(`Selamat datang, ${username}!`);
        localStorage.setItem('davaMusicUser', JSON.stringify(currentUser));
        
        // Tampilkan tombol logout, sembunyikan tombol login
        loginButton.style.display = 'none';
        logoutButton.style.display = 'flex';
      } else {
        showNotification('Silakan isi username dan password!');
      }
    }
    
    function loginWithGoogle() {
      showNotification('Mengarahkan ke login Google...');
      setTimeout(() => {
        const name = 'Pengguna Google';
        currentUser = {
          name: name,
          type: 'google'
        };
        loginText.textContent = name;
        userNameSpan.textContent = name;
        welcomeUser.style.display = 'block';
        loginContainer.classList.remove('show');
        document.body.style.overflow = 'auto';
        showNotification(`Selamat datang, ${name}!`);
        localStorage.setItem('davaMusicUser', JSON.stringify(currentUser));
        
        // Tampilkan tombol logout, sembunyikan tombol login
        loginButton.style.display = 'none';
        logoutButton.style.display = 'flex';
      }, 1000);
    }
    
    function loginWithFacebook() {
      showNotification('Mengarahkan ke login Facebook...');
      setTimeout(() => {
        const name = 'Pengguna Facebook';
        currentUser = {
          name: name,
          type: 'facebook'
        };
        loginText.textContent = name;
        userNameSpan.textContent = name;
        welcomeUser.style.display = 'block';
        loginContainer.classList.remove('show');
        document.body.style.overflow = 'auto';
        showNotification(`Selamat datang, ${name}!`);
        localStorage.setItem('davaMusicUser', JSON.stringify(currentUser));
        
        // Tampilkan tombol logout, sembunyikan tombol login
        loginButton.style.display = 'none';
        logoutButton.style.display = 'flex';
      }, 1000);
    }
    
    function loginAsGuest() {
      const name = 'Tamu';
      currentUser = {
        name: name,
        type: 'guest'
      };
      loginText.textContent = name;
      userNameSpan.textContent = name;
      welcomeUser.style.display = 'block';
      loginContainer.classList.remove('show');
      document.body.style.overflow = 'auto';
      showNotification('Anda masuk sebagai tamu. Akses terbatas.');
      localStorage.setItem('davaMusicUser', JSON.stringify(currentUser));
      
      // Tampilkan tombol logout, sembunyikan tombol login
      loginButton.style.display = 'none';
      logoutButton.style.display = 'flex';
    }
    
    function logout() {
      currentUser = null;
      loginText.textContent = 'Login';
      welcomeUser.style.display = 'none';
      showNotification('Anda telah logout.');
      localStorage.removeItem('davaMusicUser');
      
      // Tampilkan tombol login, sembunyikan tombol logout
      loginButton.style.display = 'flex';
      logoutButton.style.display = 'none';
    }
    
    // Close modals when clicking outside
    document.addEventListener('click', function(event) {
      if (event.target === loginContainer) {
        toggleLogin();
      }
      if (event.target === bgSelector) {
        toggleBgSelector();
      }
      if (event.target === playlistModal) {
        togglePlaylistModal();
      }
      if (event.target === createPlaylistModal) {
        toggleCreatePlaylistModal();
      }
      if (event.target === editPlaylistModal) {
        toggleEditPlaylistModal();
      }
      if (event.target === shareModal) {
        toggleShareModal();
      }
      if (event.target === confirmationModal) {
        toggleConfirmationModal();
      }
      if (event.target === creditsModal) {
        toggleCreditsModal();
      }
    });
    
    // Background selector
    document.querySelectorAll('.bg-option').forEach(option => {
      option.addEventListener('click', function() {
        const bgUrl = this.dataset.bg;
        setBackground(bgUrl);
        
        document.querySelectorAll('.bg-option').forEach(opt => {
          opt.classList.remove('active');
        });
        this.classList.add('active');
      });
    });
    
    // Filter songs berdasarkan view dan pencarian
    function filterSongs() {
      if (currentView === 'playlist' && currentPlaylistId) {
        const playlist = playlists.find(p => p.id === currentPlaylistId);
        if (!playlist) return [];
        return playlist.songs.map(index => songs[index]);
      }
      
      let baseSongs = [];
      
      if (currentView === 'home') {
        baseSongs = [...songs];
      } else if (currentView === 'playlist') {
        return []; // Ini akan di-handle oleh playlistGrid
      } else if (currentView === 'liked') {
        baseSongs = songs.filter((_, index) => likedSongs.includes(index));
      } else if (currentView === 'stats') {
        return [];
      }
      
      if (!searchTerm) {
        return baseSongs;
      }
      
      const lowerSearchTerm = searchTerm.toLowerCase();
      return baseSongs.filter(song => 
        song.title.toLowerCase().includes(lowerSearchTerm) || 
        song.artist.toLowerCase().includes(lowerSearchTerm)
      );
    }
    
    function updateSearchResults() {
      const filteredSongs = filterSongs();
      resultsCount.textContent = `${filteredSongs.length} hasil`;
      generateMusicPlayers();
    }
    
    // Show playlist selection modal
    function showPlaylistSelection(songIndex) {
      if (!currentUser || currentUser.type === 'guest') {
        showNotification('Silakan login untuk mengakses fitur ini');
        toggleLogin();
        return;
      }
      
      selectedSongForPlaylist = songIndex;
      populatePlaylistList();
      togglePlaylistModal();
    }
    
    // Populate playlist list in modal
    function populatePlaylistList() {
      playlistList.innerHTML = '';
      
      if (playlists.length === 0) {
        playlistList.innerHTML = '<div class="empty-playlist">Belum ada playlist. Buat playlist baru!</div>';
        return;
      }
      
      playlists.forEach(playlist => {
        const playlistItem = document.createElement('div');
        playlistItem.className = 'playlist-item';
        playlistItem.onclick = () => addToPlaylist(playlist.id);
        
        // Ambil cover dari lagu pertama di playlist
        const firstSongCover = playlist.songs.length > 0 ? songs[playlist.songs[0]].cover : 'https://i.ibb.co/0XHXb3N/cover1.jpg';
        
        playlistItem.innerHTML = `
          <img src="${firstSongCover}" alt="Playlist Cover">
          <div class="playlist-info">
            <div class="playlist-name">${playlist.name}</div>
            <div class="song-count">${playlist.songs.length} lagu</div>
          </div>
          <div class="add-icon">
            <i class="fas fa-plus"></i>
          </div>
        `;
        
        playlistList.appendChild(playlistItem);
      });
    }
    
    // Show create playlist modal
    function showCreatePlaylistModal() {
      if (!currentUser || currentUser.type === 'guest') {
        showNotification('Silakan login untuk membuat playlist');
        toggleLogin();
        return;
      }
      
      togglePlaylistModal();
      setTimeout(() => {
        toggleCreatePlaylistModal();
      }, 300);
    }
    
    // Create new playlist
    function createNewPlaylist() {
      const playlistName = document.getElementById('playlistName').value;
      
      if (!playlistName) {
        showNotification('Silakan beri nama playlist!');
        return;
      }
      
      const newPlaylist = {
        id: Date.now(),
        name: playlistName,
        songs: []
      };
      
      playlists.push(newPlaylist);
      playlistOrder.push(newPlaylist.id);
      localStorage.setItem('davaMusicPlaylists', JSON.stringify(playlists));
      localStorage.setItem('davaMusicPlaylistOrder', JSON.stringify(playlistOrder));
      
      // Tambahkan lagu jika ada yang dipilih
      if (selectedSongForPlaylist !== -1) {
        addToPlaylist(newPlaylist.id);
      }
      
      toggleCreatePlaylistModal();
      generatePlaylistCards();
      showNotification(`Playlist "${playlistName}" berhasil dibuat!`);
    }
    
    // Add song to playlist
    function addToPlaylist(playlistId) {
      if (selectedSongForPlaylist === -1) return;
      
      const playlistIndex = playlists.findIndex(p => p.id === playlistId);
      
      if (playlistIndex === -1) return;
      
      // Cek apakah lagu sudah ada di playlist
      if (!playlists[playlistIndex].songs.includes(selectedSongForPlaylist)) {
        playlists[playlistIndex].songs.push(selectedSongForPlaylist);
        localStorage.setItem('davaMusicPlaylists', JSON.stringify(playlists));
        
        showNotification(`Lagu ditambahkan ke "${playlists[playlistIndex].name}"!`);
      }
      
      togglePlaylistModal();
      selectedSongForPlaylist = -1;
    }
    
    // Fungsi untuk menampilkan notifikasi
    function showNotification(message) {
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      notification.style.position = 'fixed';
      notification.style.bottom = '100px';
      notification.style.left = '50%';
      notification.style.transform = 'translateX(-50%)';
      notification.style.backgroundColor = 'var(--primary)';
      notification.style.color = 'white';
      notification.style.padding = '10px 20px';
      notification.style.borderRadius = '20px';
      notification.style.zIndex = '2000';
      notification.style.boxShadow = '0 4px 15px rgba(0,0,0,0.3)';
      notification.style.opacity = '0';
      notification.style.transition = 'opacity 0.3s';
      
      document.body.appendChild(notification);
      
      // Animasi masuk
      setTimeout(() => {
        notification.style.opacity = '1';
      }, 10);
      
      // Animasi keluar setelah 3 detik
      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }
    
    // Generate playlist cards
    function generatePlaylistCards() {
      playlistGrid.innerHTML = '';
      
      if (playlists.length === 0) {
        playlistGrid.innerHTML = `
          <div class="empty-playlist">
            <i class="fas fa-music" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.3;"></i>
            <h3>Belum Ada Playlist</h3>
            <p>Buat playlist baru untuk mengatur lagu favoritmu</p>
            <button class="login-btn" style="margin-top: 15px; width: auto;" onclick="showCreatePlaylistModal()">
              <i class="fas fa-plus"></i> Buat Playlist
            </button>
          </div>
        `;
        return;
      }
      
      // Urutkan playlist berdasarkan playlistOrder
      const orderedPlaylists = [...playlists];
      orderedPlaylists.sort((a, b) => {
        return playlistOrder.indexOf(a.id) - playlistOrder.indexOf(b.id);
      });
      
      orderedPlaylists.forEach(playlist => {
        const card = document.createElement('div');
        card.className = 'playlist-card';
        card.dataset.id = playlist.id;
        card.draggable = true;
        card.onclick = () => openPlaylist(playlist.id);
        
        // Setup drag events
        card.addEventListener('dragstart', handleDragStart);
        card.addEventListener('dragover', handleDragOver);
        card.addEventListener('dragenter', handleDragEnter);
        card.addEventListener('dragleave', handleDragLeave);
        card.addEventListener('drop', handleDrop);
        card.addEventListener('dragend', handleDragEnd);
        
        // Ambil cover dari lagu pertama di playlist
        const firstSongCover = playlist.songs.length > 0 ? songs[playlist.songs[0]].cover : 'https://i.ibb.co/0XHXb3N/cover1.jpg';
        
        card.innerHTML = `
          <div class="cover-container">
            <img src="${firstSongCover}" alt="Cover" class="cover">
          </div>
          <div class="playlist-name">${playlist.name}</div>
          <div class="song-count">${playlist.songs.length} lagu</div>
          <button class="play-button">
            <i class="fas fa-play"></i>
          </button>
          <div class="playlist-actions">
            <button class="action-btn edit-btn" onclick="showEditPlaylistModal(${playlist.id}); event.stopPropagation();">
              <i class="fas fa-edit"></i>
            </button>
            <button class="action-btn share-btn" onclick="showShareModal(${playlist.id}); event.stopPropagation();">
              <i class="fas fa-share-alt"></i>
            </button>
            <button class="action-btn delete-btn" onclick="confirmDeletePlaylist(${playlist.id}); event.stopPropagation();">
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        `;
        
        playlistGrid.appendChild(card);
      });
    }
    
    // Drag and drop functions
    let draggedItem = null;
    
    function handleDragStart(e) {
      draggedItem = this;
      e.dataTransfer.effectAllowed = 'move';
      e.dataTransfer.setData('text/plain', this.dataset.id);
      setTimeout(() => this.classList.add('dragging'), 0);
    }
    
    function handleDragOver(e) {
      e.preventDefault();
      e.dataTransfer.dropEffect = 'move';
      return false;
    }
    
    function handleDragEnter(e) {
      this.classList.add('drag-over');
    }
    
    function handleDragLeave(e) {
      this.classList.remove('drag-over');
    }
    
    function handleDrop(e) {
      e.preventDefault();
      this.classList.remove('drag-over');
      
      const targetId = this.dataset.id;
      const draggedId = draggedItem.dataset.id;
      
      if (draggedId !== targetId) {
        // Swap positions in playlistOrder array
        const draggedIndex = playlistOrder.indexOf(draggedId);
        const targetIndex = playlistOrder.indexOf(targetId);
        
        playlistOrder.splice(draggedIndex, 1);
        playlistOrder.splice(targetIndex, 0, draggedId);
        
        localStorage.setItem('davaMusicPlaylistOrder', JSON.stringify(playlistOrder));
        generatePlaylistCards();
      }
      
      return false;
    }
    
    function handleDragEnd() {
      this.classList.remove('dragging');
      document.querySelectorAll('.playlist-card').forEach(card => {
        card.classList.remove('drag-over');
      });
    }
    
    // Show confirmation modal for deleting playlist
    function confirmDeletePlaylist(playlistId) {
      playlistToDelete = playlistId;
      toggleConfirmationModal();
    }
    
    function cancelDelete() {
      toggleConfirmationModal();
      playlistToDelete = null;
    }
    
    function confirmDelete() {
      if (playlistToDelete) {
        const playlistId = playlistToDelete;
        playlists = playlists.filter(p => p.id !== playlistId);
        playlistOrder = playlistOrder.filter(id => id !== playlistId);
        localStorage.setItem('davaMusicPlaylists', JSON.stringify(playlists));
        localStorage.setItem('davaMusicPlaylistOrder', JSON.stringify(playlistOrder));
        
        if (currentPlaylistId === playlistId) {
          currentPlaylistId = null;
          currentView = 'playlist';
        }
        
        generatePlaylistCards();
        showNotification('Playlist berhasil dihapus!');
        toggleConfirmationModal();
        playlistToDelete = null;
      }
    }
    
    // Open playlist
    function openPlaylist(playlistId) {
      currentPlaylistId = playlistId;
      currentView = 'playlist';
      viewTitle.textContent = playlists.find(p => p.id === playlistId).name;
      backButton.style.display = 'block';
      updateSearchResults();
    }
    
    // Go to home view
    function goToHome() {
      currentView = 'home';
      currentPlaylistId = null;
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      document.querySelector('.nav-item[data-view="home"]').classList.add('active');
      viewTitle.textContent = 'Temukan irama terbaik untuk harimu ðŸŽ¶';
      backButton.style.display = 'none';
      updateSearchResults();
    }
    
    // Update global audio player UI
    function updateGlobalPlayer() {
      if (currentIndex !== -1) {
        const song = songs[currentIndex];
        globalCover.src = song.cover;
        globalSongTitle.textContent = song.title;
        globalArtist.textContent = song.artist;
        globalAudioContainer.classList.add('show');
      } else {
        globalAudioContainer.classList.remove('show');
      }
    }
    
    // Format time to MM:SS
    function formatTime(seconds) {
      const min = Math.floor(seconds / 60);
      const sec = Math.floor(seconds % 60).toString().padStart(2, '0');
      return `${min}:${sec}`;
    }
    
    // Global audio event listeners
    globalAudio.addEventListener('timeupdate', () => {
      const percent = (globalAudio.currentTime / globalAudio.duration) * 100;
      globalProgress.style.width = percent + '%';
      globalCurrentTime.textContent = formatTime(globalAudio.currentTime);
      
      // Update progress bar in player card if it exists
      if (currentIndex !== -1) {
        const progressBar = document.getElementById(`progress-${currentIndex}`);
        if (progressBar) {
          progressBar.style.width = percent + '%';
        }
        const currentTimeEl = document.getElementById(`current-${currentIndex}`);
        if (currentTimeEl) {
          currentTimeEl.textContent = formatTime(globalAudio.currentTime);
        }
      }
    });
    
    globalAudio.addEventListener('loadedmetadata', () => {
      globalDuration.textContent = formatTime(globalAudio.duration);
      
      // Update duration in player card if it exists
      if (currentIndex !== -1) {
        const durationEl = document.getElementById(`duration-${currentIndex}`);
        if (durationEl) {
          durationEl.textContent = formatTime(globalAudio.duration);
        }
      }
    });
    
    globalAudio.addEventListener('ended', () => {
      playNext(currentIndex);
    });
    
    globalPlayBtn.addEventListener('click', () => {
      if (isPlaying) {
        globalAudio.pause();
        globalPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
      } else {
        globalAudio.play()
          .then(() => {
            isPlaying = true;
            globalPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
          })
          .catch(error => {
            console.error('Error playing audio:', error);
            showNotification('Terjadi kesalahan saat memutar lagu. Silakan coba lagi.');
          });
      }
      isPlaying = !isPlaying;
      
      // Update play button in player card if it exists
      if (currentIndex !== -1) {
        const playBtn = document.getElementById(`btn-${currentIndex}`);
        if (playBtn) {
          playBtn.innerHTML = `<i class="fas ${isPlaying ? 'fa-pause' : 'fa-play'}"></i>`;
        }
      }
    });
    
    // Progress bar click handler
    globalProgressBar.addEventListener('click', (e) => {
      const rect = globalProgressBar.getBoundingClientRect();
      const percent = (e.clientX - rect.left) / rect.width;
      globalAudio.currentTime = percent * globalAudio.duration;
    });
    
    // Fungsi untuk menampilkan kredit lagu
    function showCredits(songIndex) {
      currentSongForCredits = songIndex;
      const song = songs[songIndex];
      
      // Bersihkan konten sebelumnya
      creditsContent.innerHTML = '';
      
      // Tambahkan judul lagu
      const songTitle = document.createElement('div');
      songTitle.className = 'credits-item';
      songTitle.innerHTML = `
        <div class="credits-label">Judul Lagu:</div>
        <div class="credits-value">${song.title}</div>
      `;
      creditsContent.appendChild(songTitle);
      
      // Tambahkan artis
      const artist = document.createElement('div');
      artist.className = 'credits-item';
      artist.innerHTML = `
        <div class="credits-label">Artis:</div>
        <div class="credits-value">${song.artist}</div>
      `;
      creditsContent.appendChild(artist);
      
      // Tambahkan detail kredit
      for (const [key, value] of Object.entries(song.credits)) {
        const creditItem = document.createElement('div');
        creditItem.className = 'credits-item';
        
        // Format label
        const formattedKey = key.charAt(0).toUpperCase() + key.slice(1);
        
        creditItem.innerHTML = `
          <div class="credits-label">${formattedKey}:</div>
          <div class="credits-value">${value}</div>
        `;
        creditsContent.appendChild(creditItem);
      }
      
      toggleCreditsModal();
    }
    
    // Generate music players
    function generateMusicPlayers() {
      musicList.innerHTML = '';
      
      const filteredSongs = filterSongs();
      
      // Tampilkan playlist cards di view playlist
      if (currentView === 'playlist' && !currentPlaylistId) {
        playlistGrid.style.display = 'grid';
        musicList.style.display = 'none';
        generatePlaylistCards();
        return;
      } else {
        playlistGrid.style.display = 'none';
        musicList.style.display = 'grid';
      }
      
      // Tampilkan stats di view stats
      if (currentView === 'stats') {
        musicList.style.display = 'none';
        statsContainer.style.display = 'block';
        updateStats();
        return;
      } else {
        statsContainer.style.display = 'none';
      }
      
      // Tampilkan pesan jika playlist kosong
      if (currentView === 'playlist' && filteredSongs.length === 0) {
        musicList.innerHTML = `
          <div class="empty-playlist">
            <i class="fas fa-music" style="font-size: 3rem; margin-bottom: 15px; opacity: 0.3;"></i>
            <h3>Playlist Ini Kosong</h3>
            <p>Tambahkan lagu dari beranda untuk memulai</p>
          </div>
        `;
        return;
      }
      
      filteredSongs.forEach((song, index) => {
        const originalIndex = songs.findIndex(s => s.title === song.title);
        const isCurrentSong = currentIndex === originalIndex;
        const playCount = songPlays[originalIndex] || 0;
        
        const player = document.createElement('div');
        player.className = 'music-player';
        player.dataset.index = originalIndex;
        
        player.innerHTML = `
          <div class="player-top">
            <div class="cover-container">
              <img src="${song.cover}" alt="Cover" id="cover-${originalIndex}" class="cover ${isCurrentSong ? 'playing' : ''}">
              ${isCurrentSong ? '<div class="now-playing"><i class="fas fa-play"></i> Playing</div>' : ''}
              <button class="cover-btn like-btn ${likedSongs.includes(originalIndex) ? 'liked' : ''}" onclick="toggleLike(${originalIndex})">
                <i class="fas fa-heart"></i>
              </button>
              <button class="cover-btn credit-btn" onclick="showCredits(${originalIndex})">
                <i class="fas fa-info"></i>
              </button>
              <button class="cover-btn add-to-playlist-btn" onclick="showPlaylistSelection(${originalIndex})">
                <i class="fas fa-plus"></i>
              </button>
            </div>
            
            <div class="song-title">${song.title}</div>
            <div class="artist">${song.artist}</div>
            ${playCount > 0 ? `<div class="play-count">${playCount} <i class="fas fa-play"></i></div>` : ''}
          </div>
          
          <div class="player-bottom">
            <div class="controls">
              <button onclick="playPrevious(${originalIndex})"><i class="fas fa-step-backward"></i></button>
              <button id="btn-${originalIndex}" onclick="togglePlayPause(${originalIndex})">
                <i class="fas ${isCurrentSong && isPlaying ? 'fa-pause' : 'fa-play'}"></i>
              </button>
              <button onclick="playNext(${originalIndex})"><i class="fas fa-step-forward"></i></button>
            </div>
            <div class="progress-container">
              <div class="progress-bar" id="progress-bar-${originalIndex}" onclick="handleProgressClick(${originalIndex}, event)">
                <div id="progress-${originalIndex}" class="progress" style="width: ${isCurrentSong ? (globalAudio.currentTime / globalAudio.duration) * 100 + '%' : '0%'}"></div>
                <div class="progress-handle" id="handle-${originalIndex}"></div>
              </div>
              <div class="time-display">
                <span id="current-${originalIndex}">${isCurrentSong ? formatTime(globalAudio.currentTime) : '0:00'}</span>
                <span id="duration-${originalIndex}">${isCurrentSong ? formatTime(globalAudio.duration) : '0:00'}</span>
              </div>
            </div>
          </div>
        `;
        
        musicList.appendChild(player);
      });
      
      // Animate in the players with scroll animation
      const players = document.querySelectorAll('.music-player');
      players.forEach((player, i) => {
        setTimeout(() => {
          player.classList.add('animate-in');
        }, i * 100);
      });
      
      // Setup scroll animations
      setupScrollAnimations();
    }
    
    // Setup scroll animations
    function setupScrollAnimations() {
      const players = document.querySelectorAll('.music-player');
      
      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-in');
            observer.unobserve(entry.target);
          }
        });
      }, { 
        threshold: 0.1,
        rootMargin: "0px 0px -50px 0px"
      });
      
      players.forEach(player => {
        if (!player.classList.contains('animate-in')) {
          observer.observe(player);
        }
      });
    }
    
    // Function to handle progress bar click
    function handleProgressClick(index, e) {
      if (currentIndex !== index) return;
      
      const progressBar = e.currentTarget;
      const rect = progressBar.getBoundingClientRect();
      const percent = (e.clientX - rect.left) / rect.width;
      globalAudio.currentTime = percent * globalAudio.duration;
    }
    
    // Player controls
    function togglePlayPause(index) {
      // Jika lagu yang berbeda dipilih
      if (currentIndex !== index) {
        const song = songs[index];
        globalAudio.src = song.src;
        globalAudio.play()
          .then(() => {
            currentIndex = index;
            isPlaying = true;
            globalPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
            updateGlobalPlayer();
            generateMusicPlayers(); // Perbarui UI untuk menunjukkan lagu yang sedang diputar
            
            // Update play count
            songPlays[index] = (songPlays[index] || 0) + 1;
            localStorage.setItem('davaMusicSongPlays', JSON.stringify(songPlays));
          })
          .catch(error => {
            console.error('Error playing audio:', error);
            showNotification('Terjadi kesalahan saat memutar lagu. Silakan coba lagi.');
          });
        return;
      }
      
      // Jika lagu yang sama dipilih
      if (isPlaying) {
        globalAudio.pause();
        isPlaying = false;
        document.getElementById(`btn-${index}`).innerHTML = '<i class="fas fa-play"></i>';
        globalPlayBtn.innerHTML = '<i class="fas fa-play"></i>';
      } else {
        globalAudio.play()
          .then(() => {
            isPlaying = true;
            document.getElementById(`btn-${index}`).innerHTML = '<i class="fas fa-pause"></i>';
            globalPlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
          })
          .catch(error => {
            console.error('Error playing audio:', error);
            showNotification('Terjadi kesalahan saat memutar lagu. Silakan coba lagi.');
          });
      }
    }
    
    function playNext(index) {
      let nextIndex;
      const filteredSongs = filterSongs();
      
      const currentSongIndex = filteredSongs.findIndex(song => 
        songs.findIndex(s => s.title === song.title) === index
      );
      
      if (currentSongIndex !== -1) {
        nextIndex = (currentSongIndex + 1) % filteredSongs.length;
        const nextSong = filteredSongs[nextIndex];
        const nextOriginalIndex = songs.findIndex(s => s.title === nextSong.title);
        togglePlayPause(nextOriginalIndex);
      }
    }
    
    function playPrevious(index) {
      let prevIndex;
      const filteredSongs = filterSongs();
      
      const currentSongIndex = filteredSongs.findIndex(song => 
        songs.findIndex(s => s.title === song.title) === index
      );
      
      if (currentSongIndex !== -1) {
        prevIndex = (currentSongIndex - 1 + filteredSongs.length) % filteredSongs.length;
        const prevSong = filteredSongs[prevIndex];
        const prevOriginalIndex = songs.findIndex(s => s.title === prevSong.title);
        togglePlayPause(prevOriginalIndex);
      }
    }
    
    // Like functionality
    function toggleLike(index) {
      if (!currentUser) {
        showNotification('Silakan login untuk menyukai lagu');
        toggleLogin();
        return;
      }
      
      if (likedSongs.includes(index)) {
        likedSongs = likedSongs.filter(i => i !== index);
      } else {
        likedSongs.push(index);
      }
      
      // Update the like button
      const likeBtn = document.querySelector(`.music-player[data-index="${index}"] .like-btn`);
      if (likeBtn) {
        likeBtn.classList.toggle('liked');
      }
      
      // If in liked view, refresh the view
      if (currentView === 'liked') {
        updateSearchResults();
      }
      
      localStorage.setItem('davaMusicLikedSongs', JSON.stringify(likedSongs));
    }
    
    // Bottom navigation
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function() {
        // Update active state
        document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
        this.classList.add('active');
        
        // Update view
        currentView = this.dataset.view;
        currentPlaylistId = null;
        
        if (currentView === 'home') {
          viewTitle.textContent = 'Temukan irama terbaik untuk harimu ðŸŽ¶';
          backButton.style.display = 'none';
        } else if (currentView === 'playlist') {
          viewTitle.textContent = 'Playlist Kamu';
          backButton.style.display = 'block';
        } else if (currentView === 'liked') {
          viewTitle.textContent = 'Lagu Disukai';
          backButton.style.display = 'block';
        } else if (currentView === 'stats') {
          viewTitle.textContent = 'Statistik Musik';
          backButton.style.display = 'block';
        }
        
        updateSearchResults();
      });
    });
    
    // Show edit playlist modal
    function showEditPlaylistModal(playlistId) {
      if (!currentUser || currentUser.type === 'guest') {
        showNotification('Silakan login untuk mengedit playlist');
        toggleLogin();
        return;
      }
      
      playlistToEdit = playlistId;
      const playlist = playlists.find(p => p.id === playlistId);
      if (playlist) {
        editPlaylistName.value = playlist.name;
        toggleEditPlaylistModal();
      }
    }
    
    // Update playlist name
    function updatePlaylistName() {
      const newName = editPlaylistName.value;
      
      if (!newName) {
        showNotification('Silakan beri nama baru untuk playlist');
        return;
      }
      
      const playlistIndex = playlists.findIndex(p => p.id === playlistToEdit);
      if (playlistIndex !== -1) {
        playlists[playlistIndex].name = newName;
        localStorage.setItem('davaMusicPlaylists', JSON.stringify(playlists));
        generatePlaylistCards();
        showNotification(`Playlist berhasil diubah menjadi "${newName}"`);
        toggleEditPlaylistModal();
      }
    }
    
    // Show share modal
    function showShareModal(playlistId) {
      playlistToShare = playlistId;
      playlistIdSpan.textContent = playlistId;
      toggleShareModal();
    }
    
    // Copy share link
    function copyShareLink() {
      const link = document.getElementById('shareLink');
      navigator.clipboard.writeText(link.textContent)
        .then(() => {
          showNotification('Link berhasil disalin!');
        })
        .catch(err => {
          console.error('Failed to copy: ', err);
          showNotification('Gagal menyalin link');
        });
    }
    
    // Share to Facebook
    function shareToFacebook() {
      const url = encodeURIComponent(shareLink.textContent);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
    }
    
    // Share to Twitter
    function shareToTwitter() {
      const url = encodeURIComponent(shareLink.textContent);
      window.open(`https://twitter.com/intent/tweet?url=${url}`, '_blank');
    }
    
    // Share to WhatsApp
    function shareToWhatsApp() {
      const url = encodeURIComponent(shareLink.textContent);
      window.open(`https://api.whatsapp.com/send?text=${url}`, '_blank');
    }
    
    // Update stats
    function updateStats() {
      // Total listening time
      const hours = Math.floor(totalListeningTime / 3600);
      const minutes = Math.floor((totalListeningTime % 3600) / 60);
      totalListeningTimeEl.textContent = `${hours} jam ${minutes} menit`;
      
      // Total liked songs
      totalLikedSongsEl.textContent = likedSongs.length;
      
      // Top songs
      topSongsList.innerHTML = '';
      const sortedSongs = Object.entries(songPlays)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
      
      sortedSongs.forEach(([index, plays], i) => {
        const song = songs[index];
        if (song) {
          const songItem = document.createElement('li');
          songItem.className = 'top-song-item';
          songItem.innerHTML = `
            <div class="song-rank">${i + 1}</div>
            <div class="song-info">
              <div class="song-title">${song.title}</div>
              <div class="song-artist">${song.artist}</div>
            </div>
            <div class="song-plays">${plays} <i class="fas fa-play"></i></div>
          `;
          topSongsList.appendChild(songItem);
        }
      });
      
      // Top playlist
      let topPlaylist = null;
      let maxSongs = 0;
      
      playlists.forEach(playlist => {
        if (playlist.songs.length > maxSongs) {
          topPlaylist = playlist;
          maxSongs = playlist.songs.length;
        }
      });
      
      if (topPlaylist) {
        topPlaylistName.textContent = topPlaylist.name;
        topPlaylistCount.textContent = topPlaylist.songs.length;
      } else {
        topPlaylistName.textContent = '-';
        topPlaylistCount.textContent = '0';
      }
    }
    
    // Initialize the app
    function initApp() {
      // Load background from localStorage if available
      const savedBg = localStorage.getItem('davaMusicBg');
      if (savedBg) {
        setBackground(savedBg);
      }
      
      // Load playlists from localStorage
      const savedPlaylists = localStorage.getItem('davaMusicPlaylists');
      if (savedPlaylists) {
        playlists = JSON.parse(savedPlaylists);
      }
      
      // Load playlist order
      const savedPlaylistOrder = localStorage.getItem('davaMusicPlaylistOrder');
      if (savedPlaylistOrder) {
        playlistOrder = JSON.parse(savedPlaylistOrder);
      } else {
        // Initialize playlist order if not exists
        playlists.forEach(playlist => {
          playlistOrder.push(playlist.id);
        });
      }
      
      // Load liked songs
      const savedLikedSongs = localStorage.getItem('davaMusicLikedSongs');
      if (savedLikedSongs) {
        likedSongs = JSON.parse(savedLikedSongs);
      }
      
      // Load song plays
      const savedSongPlays = localStorage.getItem('davaMusicSongPlays');
      if (savedSongPlays) {
        songPlays = JSON.parse(savedSongPlays);
      }
      
      // Load total listening time
      const savedListeningTime = localStorage.getItem('davaMusicListeningTime');
      if (savedListeningTime) {
        totalListeningTime = parseInt(savedListeningTime);
      }
      
      // Load user session
      const savedUser = localStorage.getItem('davaMusicUser');
      if (savedUser) {
        currentUser = JSON.parse(savedUser);
        loginText.textContent = currentUser.name;
        userNameSpan.textContent = currentUser.name;
        welcomeUser.style.display = 'block';
        
        // Tampilkan tombol logout, sembunyikan tombol login
        loginButton.style.display = 'none';
        logoutButton.style.display = 'flex';
      } else {
        // Tampilkan tombol login, sembunyikan tombol logout
        loginButton.style.display = 'flex';
        logoutButton.style.display = 'none';
      }
      
      // Set background attachment fixed
      document.querySelector('.background-overlay').style.backgroundAttachment = 'fixed';
      
      // Setup search input listener
      searchInput.addEventListener('input', function() {
        searchTerm = this.value;
        updateSearchResults();
      });
      
      // Set active nav to home
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      document.querySelector('.nav-item[data-view="home"]').classList.add('active');
      
      // Generate music players
      updateSearchResults();
      
      // Track listening time
      setInterval(() => {
        if (isPlaying) {
          totalListeningTime++;
          localStorage.setItem('davaMusicListeningTime', totalListeningTime);
        }
      }, 1000);
    }
    
    // Initialize when page is loaded
    window.addEventListener('DOMContentLoaded', initApp);
  </script>
</body>
</html>